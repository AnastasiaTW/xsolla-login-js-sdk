{"version":3,"sources":["node_modules/browser-pack/_prelude.js","xl.min.js","src/supports.js","src/xlapi.js","src/main.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","XL","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"String","prototype","startsWith","searchString","position","indexOf","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","Event",2,"XLApi","projectId","baseUrl","makeApiCall","success","error","XMLHttpRequest","withCredentials","open","method","endpoint","onreadystatechange","readyState","status","JSON","parse","responseText","message","setRequestHeader","send","postBody","getArguments","getSocialsURLs","str","key","encodeURIComponent","loginPassAuth","login","pass","rememberMe","redirectUrl","body","username","password","remember_me","stringify","smsAuth","phoneNumber","main","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_extends","Object","assign","target","arguments","source","hasOwnProperty","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","_xlapi","_xlapi2","DEFAULT_CONFIG","errorHandler","loginPassValidator","b","isMarkupSocialsHandlersEnabled","apiUrl","maxXLClickDepth","onlyWidgets","preloader","INCORRECT_LOGIN_OR_PASSWORD_ERROR_CODE","socialUrls","eventTypes","LOAD","CLOSE","dispatcher","createElement","value","options","_this","config","api","keys","map","eventKey","on","findAncestor","el","attributes","parentElement","maxClickDepth","redirect_url","loginUrl","login_url","updateSocialLinks","response","console","setInterval","addEventListener","xlData","nodeValue","authType","prop","_this2","socialUrl","location","href","res","finishAuth","finish","createErrorObject","err","smsAuthStep","elementId","_this3","width","height","widgetBaseUrl","src","getProjectId","locale","fields","getRedirectURL","geloginUrl","widgetIframe","onload","_element","removeChild","_preloader","style","dispatchEvent","frameBorder","id","eventMethod","eventer","messageEvent","data","innerHTML","getElementById","appendChild","element","parentNode","handler","removeEventListener","onCloseEvent","result","./supports","./xlapi"],"mappings":"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","file":"xl.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",null,"/**\r\n * Created by a.korotaev on 07.11.16.\r\n */\r\nif (!String.prototype.startsWith) {\r\n    String.prototype.startsWith = function(searchString, position) {\r\n        position = position || 0;\r\n        return this.indexOf(searchString, position) === position;\r\n    };\r\n}\r\n\r\nif ( typeof window.CustomEvent !== \"function\" ) {\r\n    function CustomEvent(event, params) {\r\n        params = params || {bubbles: false, cancelable: false, detail: undefined};\r\n        var evt = document.createEvent('CustomEvent');\r\n        evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\r\n        return evt;\r\n    }\r\n\r\n    CustomEvent.prototype = window.Event.prototype;\r\n\r\n    window.CustomEvent = CustomEvent;\r\n}","/**\r\n * Created by a.korotaev on 24.06.16.\r\n */\r\n/**\r\n * Impelements Xsolla Login Api\r\n * @param projectId - project's unique identifier\r\n * @param baseUrl - api endpoint\r\n * @constructor\r\n */\r\n\r\nvar XLApi = function (projectId, baseUrl) {\r\n    var self = this;\r\n    this.baseUrl = baseUrl || '//login.xsolla.com/api/';\r\n\r\n    this.projectId = projectId;\r\n\r\n    this.makeApiCall = function (params, success, error) {\r\n        var r = new XMLHttpRequest();\r\n        r.withCredentials = true;\r\n        r.open(params.method, self.baseUrl + params.endpoint, true);\r\n        r.onreadystatechange = function () {\r\n            if (r.readyState == 4) {\r\n                if (r.status == 200) {\r\n                    success(JSON.parse(r.responseText));\r\n                } else {\r\n                    if (r.responseText) {\r\n                        error(JSON.parse(r.responseText));\r\n                    } else {\r\n                        error({error: {message: 'Networking error', code: r.status}});\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        if (params.method == 'POST') {\r\n            r.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\r\n            r.send(params.postBody);\r\n        } else if (params.method == 'GET') {\r\n            r.send(params.getArguments);\r\n        }\r\n    };\r\n};\r\n/**\r\n * Get all avialable social methods auth url\r\n * @param success - success callback\r\n * @param error - error callback\r\n * @param getArguments - additional params to send with request\r\n */\r\nXLApi.prototype.getSocialsURLs = function (success, error, getArguments) {\r\n    var str = \"\";\r\n    for (var key in getArguments) {\r\n        if (str != \"\") {\r\n            str += \"&\";\r\n        }\r\n        str += key + \"=\" + encodeURIComponent(getArguments[key]);\r\n    }\r\n\r\n    return this.makeApiCall({method: 'GET', endpoint: 'social/login_urls?' + str, getArguments: null}, success, error);\r\n};\r\n\r\nXLApi.prototype.loginPassAuth = function (login, pass, rememberMe, redirectUrl, success, error) {\r\n    var body = {\r\n        username: login,\r\n        password: pass,\r\n        remember_me: rememberMe\r\n    };\r\n    return this.makeApiCall({method: 'POST', endpoint: 'proxy/login?projectId='+this.projectId + '&redirect_url=' + encodeURIComponent(redirectUrl), postBody: JSON.stringify(body)}, success, error);\r\n};\r\n\r\nXLApi.prototype.smsAuth = function (phoneNumber, success, error) {\r\n    return this.makeApiCall({method: 'GET', endpoint: 'sms', getArguments: 'phoneNumber=' + phoneNumber}, success, error);\r\n};\r\n\r\nmodule.exports = XLApi;\r\n","/**\r\n * Created by a.korotaev on 24.06.16.\r\n */\r\nrequire('./supports');\r\n\r\nimport XLApi from './xlapi';\r\n/**\r\n * Create an `Auth0` instance with `options`\r\n *\r\n * @class XL\r\n * @constructor\r\n */\r\n\r\nconst DEFAULT_CONFIG = {\r\n    errorHandler: function (a) {\r\n    },\r\n    loginPassValidator: function (a, b) {\r\n        return true;\r\n    },\r\n    isMarkupSocialsHandlersEnabled: false,\r\n    apiUrl: '//login.xsolla.com/api/',\r\n    maxXLClickDepth: 20,\r\n    onlyWidgets: false,\r\n    preloader: '<div></div>'\r\n};\r\n\r\nconst INVALID_LOGIN_ERROR_CODE = 1;\r\nconst INCORRECT_LOGIN_OR_PASSWORD_ERROR_CODE = 2;\r\n\r\nclass XL {\r\n    constructor() {\r\n        this.socialUrls = {};\r\n        this.eventTypes = {\r\n            LOAD: 'load',\r\n            CLOSE: 'close'\r\n        };\r\n        this.dispatcher = document.createElement('div');\r\n    }\r\n\r\n    init(options) {\r\n        this.config = Object.assign({}, DEFAULT_CONFIG, options);\r\n        this.api = new XLApi(options.projectId, this.config.apiUrl);\r\n\r\n        Object.keys(this.eventTypes).map((eventKey) => {\r\n            this.on(this.eventTypes[eventKey]);\r\n        });\r\n\r\n        if (!this.config.onlyWidgets) {\r\n\r\n            let params = {};\r\n            params.projectId = options.projectId;\r\n            if (this.config.redirectUrl) {\r\n                params.redirect_url = this.config.redirectUrl;\r\n            }\r\n            if (this.config.loginUrl) {\r\n                params.login_url = this.config.loginUrl;\r\n            }\r\n\r\n            const updateSocialLinks = () => {\r\n                this.api.getSocialsURLs((response) => {\r\n                    this.socialUrls = {};\r\n                    for (let key in response) {\r\n                        if (response.hasOwnProperty(key)) {\r\n                            this.socialUrls['sn-' + key] = response[key];\r\n                        }\r\n                    }\r\n                }, (e) => {\r\n                    console.error(e);\r\n                }, params);\r\n            };\r\n\r\n            updateSocialLinks();\r\n            setInterval(updateSocialLinks, 1000 * 60 * 59);\r\n\r\n            const maxClickDepth = this.config.maxXLClickDepth;\r\n            // Find closest ancestor with data-xl-auth attribute\r\n            function findAncestor(el) {\r\n                if (el.attributes['data-xl-auth']) {\r\n                    return el;\r\n                }\r\n                let i = 0;\r\n                while ((el = el.parentElement) && !el.attributes['data-xl-auth'] && ++i < maxClickDepth);\r\n                return el;\r\n            }\r\n\r\n            if (this.config.isMarkupSocialsHandlersEnabled) {\r\n                document.addEventListener('click', (e) => {\r\n                    const target = findAncestor(e.target);\r\n                    // Do nothing if click was outside of elements with data-xl-auth\r\n                    if (!target) {\r\n                        return;\r\n                    }\r\n                    const xlData = target.attributes['data-xl-auth'];\r\n                    if (xlData) {\r\n                        let nodeValue = xlData.nodeValue;\r\n                        if (nodeValue) {\r\n                            this.login({authType: nodeValue});\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Performs login\r\n     * @param prop\r\n     * @param error - call in case error\r\n     * @param success\r\n     */\r\n    login(prop, error, success) {\r\n\r\n        if (!prop || !this.socialUrls) {\r\n            return;\r\n        }\r\n\r\n        /**\r\n         * props\r\n         * authType: sn-<social name>, login-pass, sms\r\n         */\r\n        if (prop.authType) {\r\n            if (prop.authType.startsWith('sn-')) {\r\n                const socialUrl = this.socialUrls[prop.authType];\r\n                if (socialUrl != undefined) {\r\n                    window.location.href = this.socialUrls[prop.authType];\r\n                } else {\r\n                    console.error('Auth type: ' + prop.authType + ' doesn\\'t exist');\r\n                }\r\n\r\n            } else if (prop.authType == 'login-pass') {\r\n                this.api.loginPassAuth(prop.login, prop.pass, prop.rememberMe, this.config.redirectUrl, (res) => {\r\n                    if (res.login_url) {\r\n                        const finishAuth = function () {\r\n                            window.location.href = res.login_url;\r\n                        };\r\n                        if (success) {\r\n                            success({status: 'success', finish: finishAuth, redirectUrl: res.login_url});\r\n                        } else {\r\n                            finishAuth();\r\n                        }\r\n                    } else {\r\n                        error(this.createErrorObject('Login or pass not valid', INCORRECT_LOGIN_OR_PASSWORD_ERROR_CODE));\r\n                    }\r\n                }, function (err) {\r\n                    error(err);\r\n                });\r\n            } else if (prop.authType == 'sms') {\r\n                if (smsAuthStep == 'phone') {\r\n                    this.api.smsAuth(prop.phoneNumber, null, null);\r\n                } else if (smsAuthStep == 'code') {\r\n\r\n                }\r\n            } else {\r\n                console.error('Unknown auth type');\r\n            }\r\n        }\r\n    }\r\n\r\n    createErrorObject(message, code) {\r\n        return {\r\n            error: {\r\n                message: message,\r\n                code: code || -1\r\n            }\r\n        };\r\n    };\r\n\r\n    getProjectId() {\r\n        return this.config.projectId;\r\n    };\r\n\r\n    getRedirectURL() {\r\n        return this.config.redirectUrl;\r\n    };\r\n\r\n    getLoginUrl() {\r\n        return this.config.loginUrl;\r\n    };\r\n\r\n    AuthWidget(elementId, options) {\r\n        if (this.api) {\r\n            if (!elementId) {\r\n                console.error('No div name!');\r\n            } else {\r\n                if (options == undefined) {\r\n                    options = {};\r\n                }\r\n                const width = `${options.width || 400}px`;\r\n                const height = `${options.height || 550}px`;\r\n\r\n                const widgetBaseUrl = options.widgetBaseUrl || 'https://xl-widget.xsolla.com/';\r\n\r\n                // var styleString = 'boreder:none';\r\n                let src = widgetBaseUrl + '?projectId=' + this.getProjectId();\r\n\r\n                if (this.config.locale) {\r\n                    src = src + '&locale=' + this.config.locale;\r\n                }\r\n                if (this.config.fields) {\r\n                    src = src + '&fields=' + this.config.fields;\r\n                }\r\n                const redirectUrl = this.getRedirectURL();\r\n                if (redirectUrl) {\r\n                    src = src + '&redirectUrl=' + encodeURIComponent(redirectUrl);\r\n                }\r\n\r\n                const loginUrl = this.geloginUrl();\r\n                if (loginUrl) {\r\n                     src = src + '&login_url=' + encodeURIComponent(loginUrl);\r\n                }\r\n\r\n                // var widgetHtml = '<iframe frameborder=\"0\" width=\"'+width+'\" height=\"'+height+'\"  src=\"'+src+'\">Not supported</iframe>';\r\n                const widgetIframe = document.createElement('iframe');\r\n                widgetIframe.onload = () => {\r\n                    element.removeChild(preloader);\r\n                    widgetIframe.style.width = '100%';\r\n                    widgetIframe.style.height = '100%';\r\n                    let event = new CustomEvent('load');\r\n                    this.dispatcher.dispatchEvent(event);\r\n                };\r\n                widgetIframe.style.width = 0;\r\n                widgetIframe.style.height = 0;\r\n                widgetIframe.frameBorder = '0';\r\n                widgetIframe.src = src;\r\n                widgetIframe.id = 'XsollaLoginWidgetIframe'\r\n\r\n                const eventMethod = window.addEventListener ? 'addEventListener' : 'attachEvent';\r\n                const eventer = window[eventMethod];\r\n                const messageEvent = eventMethod == 'attachEvent' ? 'onmessage' : 'message';\r\n\r\n                // Listen to message from child window\r\n                eventer(messageEvent, (e) => {\r\n                    let event = new CustomEvent(this.eventTypes[e.data]);\r\n                    this.dispatcher.dispatchEvent(event);\r\n                }, false);\r\n\r\n                const preloader = document.createElement('div');\r\n\r\n                preloader.innerHTML = this.config.preloader;\r\n\r\n                const element = document.getElementById(elementId);\r\n                if (element) {\r\n                    element.style.width = width;\r\n                    element.style.height = height;\r\n                    element.appendChild(preloader);\r\n                    element.appendChild(widgetIframe);\r\n                } else {\r\n                    console.error('Element \\\"' + elementId + '\\\" not found!');\r\n                }\r\n\r\n            }\r\n        } else {\r\n            console.error('Please run XL.init() first');\r\n        }\r\n    };\r\n\r\n    onCloseEvent() {\r\n        var element = document.getElementById('XsollaLoginWidgetIframe');\r\n        element.parentNode.removeChild(element);\r\n    }\r\n\r\n    /**\r\n     * link event with handler\r\n     * @param event\r\n     * @param handler\r\n     */\r\n\r\n    on(event, handler) {\r\n        handler = handler || null;\r\n\r\n        if (event === this.eventTypes.CLOSE) {\r\n            if (!handler) {\r\n                handler = this.onCloseEvent;\r\n            }\r\n            else {\r\n                this.dispatcher.removeEventListener(event, this.onCloseEvent);\r\n            }\r\n        }\r\n\r\n        this.dispatcher.addEventListener(event, handler);\r\n    };\r\n}\r\n\r\nconst result = new XL();\r\n\r\nmodule.exports = result;"],"sourceRoot":"."}