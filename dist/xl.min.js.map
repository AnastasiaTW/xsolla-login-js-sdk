{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","xl.min.js","src/supports.js","src/xlapi.js","src/main.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","XL","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"String","prototype","startsWith","searchString","position","indexOf","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","Event",2,"XLApi","projectId","baseUrl","makeApiCall","success","error","XMLHttpRequest","withCredentials","open","method","endpoint","onreadystatechange","readyState","status","JSON","parse","responseText","message","setRequestHeader","send","postBody","getArguments","getSocialsURLs","str","key","encodeURIComponent","loginPassAuth","login","pass","rememberMe","redirectUrl","body","username","password","remember_me","stringify","smsAuth","phoneNumber","main","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_extends","Object","assign","target","arguments","source","hasOwnProperty","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","_xlapi","_xlapi2","DEFAULT_CONFIG","errorHandler","loginPassValidator","b","isMarkupSocialsHandlersEnabled","apiUrl","maxXLClickDepth","onlyWidgets","preloader","INCORRECT_LOGIN_OR_PASSWORD_ERROR_CODE","socialUrls","eventTypes","LOAD","CLOSE","dispatcher","createElement","value","options","_this","config","api","keys","map","eventKey","on","findAncestor","el","attributes","parentElement","maxClickDepth","redirect_url","updateSocialLinks","response","console","setInterval","addEventListener","xlData","nodeValue","authType","prop","_this2","socialUrl","location","href","res","login_url","finishAuth","finish","createErrorObject","err","smsAuthStep","elementId","_this3","width","height","widgetBaseUrl","src","getProjectId","locale","fields","getRedirectURL","widgetIframe","onload","element","removeChild","style","dispatchEvent","frameBorder","id","eventMethod","eventer","messageEvent","data","innerHTML","getElementById","appendChild","parentNode","handler","removeEventListener","onCloseEvent","result","./supports","./xlapi"],"mappings":"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","file":"xl.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",null,"/**\n * Created by a.korotaev on 07.11.16.\n */\nif (!String.prototype.startsWith) {\n    String.prototype.startsWith = function(searchString, position) {\n        position = position || 0;\n        return this.indexOf(searchString, position) === position;\n    };\n}\n\nif ( typeof window.CustomEvent !== \"function\" ) {\n    function CustomEvent(event, params) {\n        params = params || {bubbles: false, cancelable: false, detail: undefined};\n        var evt = document.createEvent('CustomEvent');\n        evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n        return evt;\n    }\n\n    CustomEvent.prototype = window.Event.prototype;\n\n    window.CustomEvent = CustomEvent;\n}","/**\n * Created by a.korotaev on 24.06.16.\n */\n/**\n * Impelements Xsolla Login Api\n * @param projectId - project's unique identifier\n * @param baseUrl - api endpoint\n * @constructor\n */\n\nvar XLApi = function (projectId, baseUrl) {\n    var self = this;\n    this.baseUrl = baseUrl || '//login.xsolla.com/api/';\n\n    this.projectId = projectId;\n\n    this.makeApiCall = function (params, success, error) {\n        var r = new XMLHttpRequest();\n        r.withCredentials = true;\n        r.open(params.method, self.baseUrl + params.endpoint, true);\n        r.onreadystatechange = function () {\n            if (r.readyState == 4) {\n                if (r.status == 200) {\n                    success(JSON.parse(r.responseText));\n                } else {\n                    if (r.responseText) {\n                        error(JSON.parse(r.responseText));\n                    } else {\n                        error({error: {message: 'Networking error', code: r.status}});\n                    }\n                }\n            }\n        };\n        if (params.method == 'POST') {\n            r.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n            r.send(params.postBody);\n        } else if (params.method == 'GET') {\n            r.send(params.getArguments);\n        }\n    };\n};\n/**\n * Get all avialable social methods auth url\n * @param success - success callback\n * @param error - error callback\n * @param getArguments - additional params to send with request\n */\nXLApi.prototype.getSocialsURLs = function (success, error, getArguments) {\n    var str = \"\";\n    for (var key in getArguments) {\n        if (str != \"\") {\n            str += \"&\";\n        }\n        str += key + \"=\" + encodeURIComponent(getArguments[key]);\n    }\n\n    return this.makeApiCall({method: 'GET', endpoint: 'social/login_urls?' + str, getArguments: null}, success, error);\n};\n\nXLApi.prototype.loginPassAuth = function (login, pass, rememberMe, redirectUrl, success, error) {\n    var body = {\n        username: login,\n        password: pass,\n        remember_me: rememberMe\n    };\n    return this.makeApiCall({method: 'POST', endpoint: 'proxy/login?projectId='+this.projectId + '&redirect_url=' + encodeURIComponent(redirectUrl), postBody: JSON.stringify(body)}, success, error);\n};\n\nXLApi.prototype.smsAuth = function (phoneNumber, success, error) {\n    return this.makeApiCall({method: 'GET', endpoint: 'sms', getArguments: 'phoneNumber=' + phoneNumber}, success, error);\n};\n\nmodule.exports = XLApi;\n","/**\n * Created by a.korotaev on 24.06.16.\n */\nrequire('./supports');\n\nimport XLApi from './xlapi';\n/**\n * Create an `Auth0` instance with `options`\n *\n * @class XL\n * @constructor\n */\n\nconst DEFAULT_CONFIG = {\n    errorHandler: function (a) {\n    },\n    loginPassValidator: function (a, b) {\n        return true;\n    },\n    isMarkupSocialsHandlersEnabled: false,\n    apiUrl: '//login.xsolla.com/api/',\n    maxXLClickDepth: 20,\n    onlyWidgets: false,\n    preloader: '<div></div>'\n};\n\nconst INVALID_LOGIN_ERROR_CODE = 1;\nconst INCORRECT_LOGIN_OR_PASSWORD_ERROR_CODE = 2;\n\nclass XL {\n    constructor() {\n        this.socialUrls = {};\n        this.eventTypes = {\n            LOAD: 'load',\n            CLOSE: 'close'\n        };\n        this.dispatcher = document.createElement('div');\n    }\n\n    init(options) {\n        this.config = Object.assign({}, DEFAULT_CONFIG, options);\n        this.api = new XLApi(options.projectId, this.config.apiUrl);\n\n        Object.keys(this.eventTypes).map((eventKey) => {\n            this.on(this.eventTypes[eventKey]);\n        });\n\n        if (!this.config.onlyWidgets) {\n\n            let params = {};\n            params.projectId = options.projectId;\n            if (this.config.redirectUrl) {\n                params.redirect_url = this.config.redirectUrl;\n            }\n\n            const updateSocialLinks = () => {\n                this.api.getSocialsURLs((response) => {\n                    this.socialUrls = {};\n                    for (let key in response) {\n                        if (response.hasOwnProperty(key)) {\n                            this.socialUrls['sn-' + key] = response[key];\n                        }\n                    }\n                }, (e) => {\n                    console.error(e);\n                }, params);\n            };\n\n            updateSocialLinks();\n            setInterval(updateSocialLinks, 1000 * 60 * 59);\n\n            const maxClickDepth = this.config.maxXLClickDepth;\n            // Find closest ancestor with data-xl-auth attribute\n            function findAncestor(el) {\n                if (el.attributes['data-xl-auth']) {\n                    return el;\n                }\n                let i = 0;\n                while ((el = el.parentElement) && !el.attributes['data-xl-auth'] && ++i < maxClickDepth);\n                return el;\n            }\n\n            if (this.config.isMarkupSocialsHandlersEnabled) {\n                document.addEventListener('click', (e) => {\n                    const target = findAncestor(e.target);\n                    // Do nothing if click was outside of elements with data-xl-auth\n                    if (!target) {\n                        return;\n                    }\n                    const xlData = target.attributes['data-xl-auth'];\n                    if (xlData) {\n                        let nodeValue = xlData.nodeValue;\n                        if (nodeValue) {\n                            this.login({authType: nodeValue});\n                        }\n                    }\n                });\n            }\n        }\n    }\n\n    /**\n     * Performs login\n     * @param prop\n     * @param error - call in case error\n     * @param success\n     */\n    login(prop, error, success) {\n\n        if (!prop || !this.socialUrls) {\n            return;\n        }\n\n        /**\n         * props\n         * authType: sn-<social name>, login-pass, sms\n         */\n        if (prop.authType) {\n            if (prop.authType.startsWith('sn-')) {\n                const socialUrl = this.socialUrls[prop.authType];\n                if (socialUrl != undefined) {\n                    window.location.href = this.socialUrls[prop.authType];\n                } else {\n                    console.error('Auth type: ' + prop.authType + ' doesn\\'t exist');\n                }\n\n            } else if (prop.authType == 'login-pass') {\n                this.api.loginPassAuth(prop.login, prop.pass, prop.rememberMe, this.config.redirectUrl, (res) => {\n                    if (res.login_url) {\n                        const finishAuth = function () {\n                            window.location.href = res.login_url;\n                        };\n                        if (success) {\n                            success({status: 'success', finish: finishAuth, redirectUrl: res.login_url});\n                        } else {\n                            finishAuth();\n                        }\n                    } else {\n                        error(this.createErrorObject('Login or pass not valid', INCORRECT_LOGIN_OR_PASSWORD_ERROR_CODE));\n                    }\n                }, function (err) {\n                    error(err);\n                });\n            } else if (prop.authType == 'sms') {\n                if (smsAuthStep == 'phone') {\n                    this.api.smsAuth(prop.phoneNumber, null, null);\n                } else if (smsAuthStep == 'code') {\n\n                }\n            } else {\n                console.error('Unknown auth type');\n            }\n        }\n    }\n\n    createErrorObject(message, code) {\n        return {\n            error: {\n                message: message,\n                code: code || -1\n            }\n        };\n    };\n\n    getProjectId() {\n        return this.config.projectId;\n    };\n\n    getRedirectURL() {\n        return this.config.redirectUrl;\n    };\n\n    AuthWidget(elementId, options) {\n        if (this.api) {\n            if (!elementId) {\n                console.error('No div name!');\n            } else {\n                if (options == undefined) {\n                    options = {};\n                }\n                const width = `${options.width || 400}px`;\n                const height = `${options.height || 550}px`;\n\n                const widgetBaseUrl = options.widgetBaseUrl || 'https://xl-widget.xsolla.com/';\n\n                // var styleString = 'boreder:none';\n                let src = widgetBaseUrl + '?projectId=' + this.getProjectId();\n\n                if (this.config.locale) {\n                    src = src + '&locale=' + this.config.locale;\n                }\n                if (this.config.fields) {\n                    src = src + '&fields=' + this.config.fields;\n                }\n                const redirectUrl = this.getRedirectURL();\n                if (redirectUrl) {\n                    src = src + '&redirectUrl=' + encodeURIComponent(redirectUrl);\n                }\n\n                // var widgetHtml = '<iframe frameborder=\"0\" width=\"'+width+'\" height=\"'+height+'\"  src=\"'+src+'\">Not supported</iframe>';\n                const widgetIframe = document.createElement('iframe');\n                widgetIframe.onload = () => {\n                    element.removeChild(preloader);\n                    widgetIframe.style.width = '100%';\n                    widgetIframe.style.height = '100%';\n                    let event = new CustomEvent('load');\n                    this.dispatcher.dispatchEvent(event);\n                };\n                widgetIframe.style.width = 0;\n                widgetIframe.style.height = 0;\n                widgetIframe.frameBorder = '0';\n                widgetIframe.src = src;\n                widgetIframe.id = 'XsollaLoginWidgetIframe'\n\n                const eventMethod = window.addEventListener ? 'addEventListener' : 'attachEvent';\n                const eventer = window[eventMethod];\n                const messageEvent = eventMethod == 'attachEvent' ? 'onmessage' : 'message';\n\n                // Listen to message from child window\n                eventer(messageEvent, (e) => {\n                    let event = new CustomEvent(this.eventTypes[e.data]);\n                    this.dispatcher.dispatchEvent(event);\n                }, false);\n\n                const preloader = document.createElement('div');\n\n                preloader.innerHTML = this.config.preloader;\n\n                const element = document.getElementById(elementId);\n                if (element) {\n                    element.style.width = width;\n                    element.style.height = height;\n                    element.appendChild(preloader);\n                    element.appendChild(widgetIframe);\n                } else {\n                    console.error('Element \\\"' + elementId + '\\\" not found!');\n                }\n\n            }\n        } else {\n            console.error('Please run XL.init() first');\n        }\n    };\n\n    onCloseEvent() {\n        var element = document.getElementById('XsollaLoginWidgetIframe');\n        element.parentNode.removeChild(element);\n    }\n\n    /**\n     * link event with handler\n     * @param event\n     * @param handler\n     */\n\n    on(event, handler) {\n        handler = handler || null;\n\n        if (event === this.eventTypes.CLOSE) {\n            if (!handler) {\n                handler = this.onCloseEvent;\n            }\n            else {\n                this.dispatcher.removeEventListener(event, this.onCloseEvent);\n            }\n        }\n\n        this.dispatcher.addEventListener(event, handler);\n    };\n}\n\nconst result = new XL();\n\nmodule.exports = result;"],"sourceRoot":"."}