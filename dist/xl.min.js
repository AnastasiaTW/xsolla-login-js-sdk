!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.XL=t()}}(function(){return function t(e,o,n){function r(s,a){if(!o[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var p=o[s]={exports:{}};e[s][0].call(p.exports,function(t){var o=e[s][1][t];return r(o?o:t)},p,p.exports,t,e,o,n)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,o){var n=function(t){var e=this;this.baseUrl="http://test-login.xsolla.com/api/",this.projectId=t,this.makeApiCall=function(t,o,n){console.log("asdasd");var r=new XMLHttpRequest;r.open(t.method,e.baseUrl+t.endpoint,!0),r.onreadystatechange=function(){4==r.readyState&&(200==r.status?o(JSON.parse(r.responseText)):n(r.responseText?JSON.parse(r.responseText):{error:{message:"Networking error"}}))},r.send(t.getArguments)}};n.prototype.getSocialsURLs=function(t,e){return this.makeApiCall({method:"GET",endpoint:"social/login_urls?projectId="+this.projectId,getArguments:null},t,e)},n.prototype.loginPassAuth=function(t,e,o,n){var r={username:t,password:e};return this.makeApiCall({method:"POST",endpoint:"proxy/login?projectId="+this.projectId,getArguments:JSON.stringify(r)},o,n)},n.prototype.smsAuth=function(t,e,o){return this.makeApiCall({method:"GET",endpoint:"sms",getArguments:"phoneNumber="+t},e,o)},e.exports=n},{}],main:[function(t,e,o){function n(t){var e=this;e._socialUrls=void 0,e._options={},e._options.errorHandler=t.errorHandler||function(t){},e._options.loginPassValidator=t.loginPassValidator||function(t,e){return!0},e._api=new r(t.projectId),e._api.getSocialsURLs(function(t){e._socialUrls={};for(var o in t)t.hasOwnProperty(o)&&(e._socialUrls["sn-"+o]=t[o])},function(t){console.error(t)});for(var o=e.getAllElementsWithAttribute("data-xl-auth"),i="",s="",a=0;a<o.length;a++){var l=o[a].attributes["data-xl-auth"].nodeValue;l.startsWith("sn")?o[a].onclick=function(t){return function(){e.login({authType:t})}}(l):"form-sms"==l||("form-login_pass"==l?o[a].onsubmit=function(t,o){return function(r){r.preventDefault(),e._options.loginPassValidator(t,o)?e.login({authType:"login-pass",login:t,pass:o},function(t){t.error&&e._options.errorHandler(t)}):e._options.errorHandler(e.createErrorObject("Login or pass not valid",n.INVALID_LOGIN_ERROR_CODE))}}(i,s):l.startsWith("input-")&&("input-login"==l?i="":"input-pass"==l&&(s="")))}}var r=t("./xlapi");n.prototype.login=function(t,e){var o=this;if(t&&o._socialUrls&&t.authType)if(t.authType.startsWith("sn-")){var r=o._socialUrls[t.authType];void 0!=r?window.location.href=o._socialUrls[t.authType]:console.error("Auth type: "+t.authType+" doesn't exist")}else"login-pass"==t.authType?o._api.loginPassAuth(t.login,t.pass,function(t){res.login_url?window.location.href=res.login_url:e(o.createErrorObject("Login or pass not valid",n.INCORRECT_LOGIN_OR_PASSWORD_ERROR_CODE))},function(t){e(t)}):"sms"==t.authType?"phone"==smsAuthStep?o._api.smsAuth(t.phoneNumber,null,null):"code"==smsAuthStep:console.error("Unknown auth type")},n.prototype.getAllElementsWithAttribute=function(t){for(var e=[],o=document.getElementsByTagName("*"),n=0,r=o.length;r>n;n++)null!==o[n].getAttribute(t)&&e.push(o[n]);return e},n.prototype.createErrorObject=function(t,e){return{error:{message:t,code:e||-1}}},n.INVALID_LOGIN_ERROR_CODE=1,n.INCORRECT_LOGIN_OR_PASSWORD_ERROR_CODE=2,e.exports=n},{"./xlapi":1}]},{},["main"])("main")});
//# sourceMappingURL=xl.min.js.map